<!-- app/templates/admin/product_add.html -->
{% extends "admin/base.html" %}

{% block title %}添加产品{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-10">
        <h2 class="section-title mb-4">添加新产品</h2>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show mb-4">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="card p-4 shadow-sm">
            <form method="POST" enctype="multipart/form-data">
                <div class="row">
                    <div class="col-md-8">
                        <div class="mb-3">
                            <label for="name" class="form-label fw-bold">产品名称（Product Name）<span class="text-danger ms-1">*</span></label>
                            <input type="text" class="form-control form-control-lg" id="name" name="name" required placeholder="例如：King Size Luxury Hotel Bed">
                        </div>

                        <!-- 新增：产品编号输入框 -->
                        <div class="mb-3">
                            <label for="product_code" class="form-label fw-bold">产品编号（Product Code）<span class="text-danger ms-1">*</span></label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text bg-light">pc</span>
                                <input type="text" 
                                       class="form-control" 
                                       id="product_code" 
                                       name="product_code" 
                                       pattern="[0-9]{9}" 
                                       maxlength="9" 
                                       placeholder="留空自动生成，或输入9位数字">
                            </div>
                            <div class="form-text">
                                留空将<strong>自动生成唯一编号</strong>（如 pc284539245）。<br>
                                也可手动输入9位数字（保存后自动加前缀 pc），但必须唯一。
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="description" class="form-label fw-bold">产品描述（Description）</label>
                            <textarea class="form-control" id="description" name="description" rows="5" placeholder="详细描述产品特点、工艺、材质等"></textarea>
                        </div>

                        <div class="mb-3">
                            <label for="category_id" class="form-label fw-bold">产品分类（Category）<span class="text-danger ms-1">*</span></label>
                            <select class="form-select form-select-lg" id="category_id" name="category_id" required>
                                <option value="">请选择分类</option>
                                {% for cat in categories %}
                                    <option value="{{ cat.id }}">{{ cat.name }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="length" class="form-label">长 Length (mm)</label>
                                <input type="number" class="form-control" id="length" name="length" min="0">
                            </div>
                            <div class="col-md-3">
                                <label for="width" class="form-label">宽 Width (mm)</label>
                                <input type="number" class="form-control" id="width" name="width" min="0">
                            </div>
                            <div class="col-md-3">
                                <label for="height" class="form-label">高 Height (mm)</label>
                                <input type="number" class="form-control" id="height" name="height" min="0">
                            </div>
                            <div class="col-md-3">
                                <label for="seat_height" class="form-label">座高 Seat Height (mm)</label>
                                <input type="number" class="form-control" id="seat_height" name="seat_height" min="0" placeholder="仅椅子/沙发">
                                <div class="form-text">可选</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="base_material" class="form-label fw-bold">基材（Base Material）</label>
                            <input type="text" class="form-control" id="base_material" name="base_material" placeholder="例如：Solid Wood, Metal Frame, Engineered Wood">
                        </div>

                        <div class="mb-3">
                            <label for="surface_material" class="form-label fw-bold">覆面（Surface Material）</label>
                            <input type="text" class="form-control" id="surface_material" name="surface_material" placeholder="例如：Premium Fabric, Genuine Leather, High-Gloss Lacquer">
                        </div>

                        <div class="mb-3">
                            <label for="applicable_space" class="form-label fw-bold">适用空间（Applicable Space）</label>
                            <input type="text" class="form-control" id="applicable_space" name="applicable_space"
                                   placeholder="例如：Guest Room, Lobby, Suite, Restaurant">
                            <div class="form-text">多个空间用英文逗号分隔</div>
                        </div>

                        <div class="mb-4">
                            <label for="featured_series" class="form-label fw-bold">精选系列（Featured Series）</label>
                            <input type="text" class="form-control" id="featured_series" name="featured_series"
                                   placeholder="例如：Modern Hotel Series, Luxury Classic Series, Contemporary Collection">
                            <div class="form-text">多个系列用英文逗号分隔</div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="mb-4">
                            <label for="photos" class="form-label fw-bold">产品图片（最多10张）<span class="text-danger ms-1">*</span></label>
                            <input class="form-control form-control-lg" type="file" id="photos" name="photos" accept="image/*" multiple required>
                            <div class="form-text mt-2">
                                支持同时选择多张图片（Ctrl+点击或拖拽）。<br>
                                <strong>第一张将作为主图</strong>（用于列表和详情页头部），其余用于产品画廊展示。<br>
                                建议上传高清专业摄影图。
                            </div>
                        </div>
                    </div>
                </div>

                <div class="text-center mt-5">
                    <button type="submit" class="btn btn-primary btn-lg px-5">保存产品</button>
                    <a href="{{ url_for('admin.product_list') }}" class="btn btn-outline-secondary btn-lg px-5 ms-3">取消</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
